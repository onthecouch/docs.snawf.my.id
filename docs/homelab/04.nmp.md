# 123 - NPM (Nginx Proxy Manager - SSL/Reverse Proxy)

**ID:** `106`  
**IP Address:** `10.10.10.6`  
**Method:** Docker inside LXC

---

### 1\. Provisioning Specs

_Container configuration details._

| Component | Specification | Notes |
| --- | --- | --- |
| **OS Template** | Debian 12 (Bookworm) | Unprivileged LXC |
| **vCPU** | 1 Core | Low usage |
| **RAM** | 512 MB | Docker engine overhead included |
| **Storage** | 10 GB | `local-lvm` |
| **Network** | Static IPv4 | CIDR: `10.10.10.6/24` |
| **LXC Flags** | `Nesting=1`, `Keyctl=1` | **Required** for Docker execution |

:::danger
**Critical:** The "Nesting" feature must be enabled in Proxmox _Options_ before starting the container, or Docker will fail to initialize.
:::

---

### 2\. Deployment Log

**Method:** Docker Compose (Manual)

#### A. Environment Prep

```bash
# System Update
apt update && apt upgrade -y
apt install curl sudo -y

# Docker Installation (Official Script)
curl -fsSL [https://get.docker.com](https://get.docker.com) -o get-docker.sh
sh get-docker.sh
```

#### B. Compose Configuration (`/opt/npm/docker-compose.yml`)

_Note: Ports bound to all interfaces to allow LAN access._

```yaml
services:
  app:
    image: 'jc21/nginx-proxy-manager:latest'
    restart: unless-stopped
    ports:
      - "80:80"     # HTTP Ingress
      - "81:81"     # Admin Interface
      - "443:443"   # HTTPS Ingress
    volumes:
      - ./data:/data
      - ./letsencrypt:/etc/letsencrypt
```

**C. Service Start**

```bash
cd /opt/npm
docker compose up -d
```

---

### 3\. Initial Configuration

**Access URL:** `http://10.10.10.6:81`

- **Default Credentials:**
    - **User:** `admin@example.com`
    - **Pass:** `changeme`
- **Status:** Credentials updated to secure admin account immediately.

---

### 4\. Routing Strategy (Internal Only)

**Constraint:** ISP Router locked; Public ingress unavailable. **Role:** Clean URL management for local LAN traffic (SSL/HTTPS).

#### Workflow

1.  **DNS (AdGuard):** Resolves `*.snawf.my.id` (or `*.home`) to the **Proxy IP** (`10.10.10.6`).
2.  **Ingress (NPM):** Accepts traffic on Port 80/443.
3.  **Reverse Proxy:** Inspects hostname (e.g., `jellyfin.snawf.my.id`) and forwards to the specific **Service IP** (`10.10.10.118:8096`).

#### Configuration Example (Jellyfin)

|     |     |     |
| --- | --- | --- |
| Step | Service | Action |
| **1** | **AdGuard** | DNS Rewrite: `jellyfin.home` → `10.10.10.6` |
| **2** | **NPM** | Proxy Host: `jellyfin.home` → `10.10.10.118:8096` |
| **3** | **Client** | Browses to `jellyfin.home` (Valid SSL) |
# 120 - AdGuard Home (DNS/Adblock)

**ID:** `105`  
**IP Address:** `10.10.10.5`  
**Version:** Latest Stable

---

### 1\. Network Topology

**Constraint:** ISP Modem is locked. DNS logic is offloaded to the Secondary Router and Proxmox.

**Traffic Flow:**  
`ISP Router (Bridge/Locked)` → `Secondary Router (10.10.10.1)` → `Proxmox Node` → `AdGuard LXC (10.10.10.5)`

---

### 2\. Provisioning Specs

_Container configuration details._

| Component | Specification | Notes |
| --- | --- | --- |
| **OS Template** | Debian 12 (Bookworm) | Unprivileged LXC |
| **vCPU** | 1 Core | Low usage |
| **RAM** | 512 MB | Increase to 1GB if log retention > 7 days |
| **Storage** | 8 GB | `local-lvm` |
| **Network** | Static IPv4 | CIDR: `10.10.10.5/24` |
| **Gateway** | `10.10.10.1` | Secondary Router |

---

### 3\. Deployment Log

**Method:** Binary Install (Manual)

#### A. Environment Prep

```bash
apt update && apt upgrade -y
apt install curl sudo tar -y
```

#### B. Installation

```bash
# Fetch and extract
curl -s -S -L [https://static.adguard.com/adguardhome/release/AdGuardHome_linux_amd64.tar.gz](https://static.adguard.com/adguardhome/release/AdGuardHome_linux_amd64.tar.gz) | tar xz

# Install Service
cd AdGuardHome
./AdGuardHome -s install
```

#### C. Initial Wizard (`http://10.10.10.5:3000`)

- **Listening Interface:** All Interfaces
- **Admin Port:** `3000`
- **DNS Port:** `53`

---

### 4\. Router Integration (Critical)

_Device: Tianyi Secondary Router_

To force network-wide ad-blocking, the router's DHCP settings were updated to bypass the ISP DNS.

|     |     |     |
| --- | --- | --- |
| **Setting** | **Value** | **Reason** |
| **Primary DNS** | `10.10.10.5` | Points to AdGuard LXC |
| **Secondary DNS** | **\[EMPTY\]** | **Crucial.** Prevents devices from bypassing the filter. |

---

### 5\. Configuration Strategy

#### A. Upstream Resolvers

_Where AdGuard sends non-blocked traffic._

- **Primary:** `1.1.1.1` (Cloudflare)
- **Secondary:** `1.0.0.1`
- **Bootstrap:** `1.1.1.1`

#### B. Security Hardening (Blocklists)

_Policy: Layered Defense (General Ads + Malware + Privacy)._

|     |     |     |
| --- | --- | --- |
| Layer | List Name | Purpose |
| **Baseline** | AdGuard DNS Filter | Official basic blocking. Low false positives. |
| **Aggressive** | **HaGeZi's Pro** | The heavy lifter. Aggressive blocking of ads/trackers. |
| **Security** | URLHaus Malicious URLs | Blocks active malware distribution sites. |
| **Security** | Big List of Hacked Malware | Blocks compromised legitimate sites. |
| **Privacy** | HaGeZi Windows Telemetry | Blocks Microsoft data collection/telemetry. |
| **Privacy** | HaGeZi URL Shortener | Blocks shady link shorteners. |
| **Regional** | **ABPindo** | Targeted filters for Indonesian ads/scams. |

---

### 6\. Verification

**Command:** `nslookup google.com` (from a client PC)

- **Expected Server:** `10.10.10.5` (AdGuard)
- **Success Indicator:** AdGuard Dashboard "Query Log" increments immediately.